sample = {
    "channel": {
        "S": "Direct Sales"
    },
    "channel_sub_channel_id": {
        "S": "10"
    },
    "channel_sub_channel_name": {
        "S": "Direct - DSC"
    },
    "designation": {
        "L": [
            {
                "M": {
                    "designation_id": {
                        "S": "5"
                    },
                    "designation_name": {
                        "S": "Sales Manager"
                    }
                }
            },
            {
                "M": {
                    "designation_id": {
                        "S": "6"
                    },
                    "designation_name": {
                        "S": "Sr. Sales Manager"
                    }
                }
            },
            {
                "M": {
                    "designation_id": {
                        "S": "1"
                    },
                    "designation_name": {
                        "S": "Assistant Sales Manager"
                    }
                }
            },
            {
                "M": {
                    "designation_id": {
                        "S": "8"
                    },
                    "designation_name": {
                        "S": "Direct Sales Manager"
                    }
                }
            },
            {
                "M": {
                    "designation_id": {
                        "S": "3"
                    },
                    "designation_name": {
                        "S": "Executive Sales Manager"
                    }
                }
            },
            {
                "M": {
                    "designation_id": {
                        "S": "4"
                    },
                    "designation_name": {
                        "S": "Financial Planning Manager"
                    }
                }
            }
        ]
    },
    "segments": {
        "L": [
            {
                "M": {
                    "demoseg_id": {
                        "N": "1"
                    },
                    "demoseg_name": {
                        "S": "Urban Lateral Hires"
                    },
                    "segment_id": {
                        "N": "15"
                    },
                    "segment_name": {
                        "S": "Urban Lateral Hires_Policy Champs"
                    },
                    "valueseg_description": {
                        "S": "High number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "5"
                    },
                    "valueseg_name": {
                        "S": "Policy Champs"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "1"
                    },
                    "demoseg_name": {
                        "S": "Urban Lateral Hires"
                    },
                    "segment_id": {
                        "N": "11"
                    },
                    "segment_name": {
                        "S": "Urban Lateral Hires_Potentials"
                    },
                    "valueseg_description": {
                        "S": "Relatively high number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "1"
                    },
                    "valueseg_name": {
                        "S": "Potentials"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "1"
                    },
                    "demoseg_name": {
                        "S": "Urban Lateral Hires"
                    },
                    "segment_id": {
                        "N": "12"
                    },
                    "segment_name": {
                        "S": "Urban Lateral Hires_Middle Joes"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "2"
                    },
                    "valueseg_name": {
                        "S": "Middle Joes"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "1"
                    },
                    "demoseg_name": {
                        "S": "Urban Lateral Hires"
                    },
                    "segment_id": {
                        "N": "14"
                    },
                    "segment_name": {
                        "S": "Urban Lateral Hires_Profitable Moderates"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high rider attachment rate and profitable product mix"
                    },
                    "valueseg_id": {
                        "N": "4"
                    },
                    "valueseg_name": {
                        "S": "Profitable Moderates"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "1"
                    },
                    "demoseg_name": {
                        "S": "Urban Lateral Hires"
                    },
                    "segment_id": {
                        "N": "13"
                    },
                    "segment_name": {
                        "S": "Urban Lateral Hires_Low Pulse"
                    },
                    "valueseg_description": {
                        "S": "Low number of policies with low FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "3"
                    },
                    "valueseg_name": {
                        "S": "Low Pulse"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "2"
                    },
                    "demoseg_name": {
                        "S": "Small town Established"
                    },
                    "segment_id": {
                        "N": "25"
                    },
                    "segment_name": {
                        "S": "Small town Established_Policy Champs"
                    },
                    "valueseg_description": {
                        "S": "High number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "5"
                    },
                    "valueseg_name": {
                        "S": "Policy Champs"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "2"
                    },
                    "demoseg_name": {
                        "S": "Small town Established"
                    },
                    "segment_id": {
                        "N": "21"
                    },
                    "segment_name": {
                        "S": "Small town Established_Potentials"
                    },
                    "valueseg_description": {
                        "S": "Relatively high number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "1"
                    },
                    "valueseg_name": {
                        "S": "Potentials"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "2"
                    },
                    "demoseg_name": {
                        "S": "Small town Established"
                    },
                    "segment_id": {
                        "N": "22"
                    },
                    "segment_name": {
                        "S": "Small town Established_Middle Joes"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "2"
                    },
                    "valueseg_name": {
                        "S": "Middle Joes"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "2"
                    },
                    "demoseg_name": {
                        "S": "Small town Established"
                    },
                    "segment_id": {
                        "N": "24"
                    },
                    "segment_name": {
                        "S": "Small town Established_Profitable Moderates"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high rider attachment rate and profitable product mix"
                    },
                    "valueseg_id": {
                        "N": "4"
                    },
                    "valueseg_name": {
                        "S": "Profitable Moderates"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "2"
                    },
                    "demoseg_name": {
                        "S": "Small town Established"
                    },
                    "segment_id": {
                        "N": "23"
                    },
                    "segment_name": {
                        "S": "Small town Established_Low Pulse"
                    },
                    "valueseg_description": {
                        "S": "Low number of policies with low FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "3"
                    },
                    "valueseg_name": {
                        "S": "Low Pulse"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "3"
                    },
                    "demoseg_name": {
                        "S": "Urban Sophomores"
                    },
                    "segment_id": {
                        "N": "35"
                    },
                    "segment_name": {
                        "S": "Urban Sophomores_Policy Champs"
                    },
                    "valueseg_description": {
                        "S": "High number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "5"
                    },
                    "valueseg_name": {
                        "S": "Policy Champs"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "3"
                    },
                    "demoseg_name": {
                        "S": "Urban Sophomores"
                    },
                    "segment_id": {
                        "N": "31"
                    },
                    "segment_name": {
                        "S": "Urban Sophomores_Potentials"
                    },
                    "valueseg_description": {
                        "S": "Relatively high number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "1"
                    },
                    "valueseg_name": {
                        "S": "Potentials"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "3"
                    },
                    "demoseg_name": {
                        "S": "Urban Sophomores"
                    },
                    "segment_id": {
                        "N": "32"
                    },
                    "segment_name": {
                        "S": "Urban Sophomores_Middle Joes"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "2"
                    },
                    "valueseg_name": {
                        "S": "Middle Joes"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "3"
                    },
                    "demoseg_name": {
                        "S": "Urban Sophomores"
                    },
                    "segment_id": {
                        "N": "34"
                    },
                    "segment_name": {
                        "S": "Urban Sophomores_Profitable Moderates"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high rider attachment rate and profitable product mix"
                    },
                    "valueseg_id": {
                        "N": "4"
                    },
                    "valueseg_name": {
                        "S": "Profitable Moderates"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "3"
                    },
                    "demoseg_name": {
                        "S": "Urban Sophomores"
                    },
                    "segment_id": {
                        "N": "33"
                    },
                    "segment_name": {
                        "S": "Urban Sophomores_Low Pulse"
                    },
                    "valueseg_description": {
                        "S": "Low number of policies with low FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "3"
                    },
                    "valueseg_name": {
                        "S": "Low Pulse"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "4"
                    },
                    "demoseg_name": {
                        "S": "Urban Established"
                    },
                    "segment_id": {
                        "N": "45"
                    },
                    "segment_name": {
                        "S": "Urban Established_Policy Champs"
                    },
                    "valueseg_description": {
                        "S": "High number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "5"
                    },
                    "valueseg_name": {
                        "S": "Policy Champs"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "4"
                    },
                    "demoseg_name": {
                        "S": "Urban Established"
                    },
                    "segment_id": {
                        "N": "41"
                    },
                    "segment_name": {
                        "S": "Urban Established_Potentials"
                    },
                    "valueseg_description": {
                        "S": "Relatively high number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "1"
                    },
                    "valueseg_name": {
                        "S": "Potentials"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "4"
                    },
                    "demoseg_name": {
                        "S": "Urban Established"
                    },
                    "segment_id": {
                        "N": "42"
                    },
                    "segment_name": {
                        "S": "Urban Established_Middle Joes"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "2"
                    },
                    "valueseg_name": {
                        "S": "Middle Joes"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "4"
                    },
                    "demoseg_name": {
                        "S": "Urban Established"
                    },
                    "segment_id": {
                        "N": "44"
                    },
                    "segment_name": {
                        "S": "Urban Established_Profitable Moderates"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high rider attachment rate and profitable product mix"
                    },
                    "valueseg_id": {
                        "N": "4"
                    },
                    "valueseg_name": {
                        "S": "Profitable Moderates"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "4"
                    },
                    "demoseg_name": {
                        "S": "Urban Established"
                    },
                    "segment_id": {
                        "N": "43"
                    },
                    "segment_name": {
                        "S": "Urban Established_Low Pulse"
                    },
                    "valueseg_description": {
                        "S": "Low number of policies with low FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "3"
                    },
                    "valueseg_name": {
                        "S": "Low Pulse"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "5"
                    },
                    "demoseg_name": {
                        "S": "Middle aged Freshers"
                    },
                    "segment_id": {
                        "N": "55"
                    },
                    "segment_name": {
                        "S": "Middle aged Freshers_Policy Champs"
                    },
                    "valueseg_description": {
                        "S": "High number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "5"
                    },
                    "valueseg_name": {
                        "S": "Policy Champs"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "5"
                    },
                    "demoseg_name": {
                        "S": "Middle aged Freshers"
                    },
                    "segment_id": {
                        "N": "51"
                    },
                    "segment_name": {
                        "S": "Middle aged Freshers_Potentials"
                    },
                    "valueseg_description": {
                        "S": "Relatively high number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "1"
                    },
                    "valueseg_name": {
                        "S": "Potentials"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "5"
                    },
                    "demoseg_name": {
                        "S": "Middle aged Freshers"
                    },
                    "segment_id": {
                        "N": "52"
                    },
                    "segment_name": {
                        "S": "Middle aged Freshers_Middle Joes"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "2"
                    },
                    "valueseg_name": {
                        "S": "Middle Joes"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "5"
                    },
                    "demoseg_name": {
                        "S": "Middle aged Freshers"
                    },
                    "segment_id": {
                        "N": "54"
                    },
                    "segment_name": {
                        "S": "Middle aged Freshers_Profitable Moderates"
                    },
                    "valueseg_description": {
                        "S": "Average number of monthly policies with high rider attachment rate and profitable product mix"
                    },
                    "valueseg_id": {
                        "N": "4"
                    },
                    "valueseg_name": {
                        "S": "Profitable Moderates"
                    }
                }
            },
            {
                "M": {
                    "demoseg_id": {
                        "N": "5"
                    },
                    "demoseg_name": {
                        "S": "Middle aged Freshers"
                    },
                    "segment_id": {
                        "N": "53"
                    },
                    "segment_name": {
                        "S": "Middle aged Freshers_Low Pulse"
                    },
                    "valueseg_description": {
                        "S": "Low number of policies with low FYFP and sum assured"
                    },
                    "valueseg_id": {
                        "N": "3"
                    },
                    "valueseg_name": {
                        "S": "Low Pulse"
                    }
                }
            }
        ]
    },
    "sub_channel": {
        "S": "DSC"
    }
}
x = {
    "CRM_lead_id": {
        "S": "1-38181166750"
    },
    "delta_details": {
        "M": {
            "lead_contact": {
                "S": "8090203068"
            },
            "lead_email": {
                "S": "RANADIWAKAR80@gmail.com"
            },
            "lead_name": {
                "S": "Diwakar sen"
            },
            "lead_status": {
                "S": "New"
            }
        }
    },
    "lead_data_source": {
        "S": "OPS"
    },
    "lead_email_address": {
        "S": "RANADIWAKAR80@gmail.com"
    },
    "lead_emp_pr_postn_id": {
        "S": "0-5220"
    },
    "lead_first_name": {
        "S": "Diwakar sen"
    },
    "lead_generation_date": {
        "S": "2019-11-16T06:43:40Z"
    },
    "lead_joint_call_request": {
        "S": "N"
    },
    "lead_joint_call_took_place": {
        "S": "N"
    },
    "lead_last_name": {
        "S": "Linesman"
    },
    "lead_lf_pr_postn_id": {
        "S": "0-5220"
    },
    "lead_mobile_number": {
        "S": "8090203068"
    },
    "lead_pr_postn_id": {
        "S": "0-5220"
    },
    "lead_source": {
        "S": "Sourced by channel partner"
    },
    "lead_status": {
        "S": "New"
    },
    "lead_type": {
        "S": "Default"
    },
    "lf_id": {
        "S": "1-H37F"
    },
    "lg_id": {
        "S": "1-H37F"
    },
    "row_id": {
        "S": "1-HJG2WTA"
    },
    "updated_dttm": {
        "S": "2020-02-18T21:39:29.858832Z"
    }
}
NewImage = {
    "head": {
        "M": {
            "chnlid": {
                "S": "DIRECT"
            },
            "subchnlid": {
                "S": "DIRECT"
            }
        }
    },
    "instago_lead_id": {
        "S": "123186|20200225162405"
    },
    "lead": {
        "M": {
            "addr": {
                "L": [
                    {
                        "M": {
                            "addrtype": {
                                "S": "Residence"
                            },
                            "city": {
                                "S": "Mumbai"
                            },
                            "cntry": {
                                "S": "India"
                            },
                            "flatno": {
                                "S": "301c2"
                            },
                            "landmark": {
                                "S": "bptp"
                            },
                            "pincode": {
                                "S": "121002"
                            },
                            "state": {
                                "S": "Maharashtra"
                            },
                            "street": {
                                "S": "sec 77"
                            }
                        }
                    }
                ]
            },
            "cntrycodemobno": {
                "S": "91"
            },
            "datasrc": {
                "S": "GEO-SERCO"
            },
            "email": {
                "S": " "
            },
            "firstnm": {
                "S": "NEW TEST 1"
            },
            "hnicustomer": {
                "S": "N"
            },
            "isGo": {
                "S": "Y"
            },
            "landmark": {
                "S": "Mumbai"
            },
            "lastnm": {
                "S": "UAT"
            },
            "latitude": {
                "S": "28.449776"
            },
            "leadstatus": {
                "S": "New"
            },
            "leadtype": {
                "S": "Default"
            },
            "LFuserid": {
                "S": " "
            },
            "LGuserid": {
                "S": "DIRECT_DSC"
            },
            "login": {
                "S": "DIRECT_DSC"
            },
            "longitude": {
                "S": "77.075356"
            },
            "mobno": {
                "S": "7428556950"
            },
            "mtgdonecmnt": {
                "S": " "
            },
            "mtgdonedt": {
                "S": " "
            },
            "mtgschddt": {
                "S": "01/26/2020 01:00:00"
            },
            "notes": {
                "L": [
                    {
                        "M": {
                            "cmnt": {
                                "S": " "
                            }
                        }
                    }
                ]
            },
            "partnerleadid": {
                "S": "053249796799"
            },
            "reason": {
                "NULL": True
            },
            "srctype": {
                "S": "Asset"
            },
            "x_is_go": {
                "S": "Y"
            }
        }
    },
    "record_last_updated": {
        "S": "2020-02-25T16:31:21.848529Z"
    },
    "user_id": {
        "S": "123186"
    }
}


def flatten_dynamo_list(list_of_dynamodict):
    try:
        clean1 = [ele.get("M") for ele in list_of_dynamodict]
        flat_list = [{key: list(ele[key].values())[0] for key in ele.keys()} for ele in clean1]
    except TypeError as e:
        print("No Records in List!")
        return []
    return flat_list


def flatten_dynamo_image(sample):
    flat_dict = {}

    for k, v in sample.items():

        if isinstance(sample.get(k), dict):

            for k1, v1 in sample.get(k).items():
                flat_dict[k] = v1

                if k1 == 'L':
                    flat_dict[k] = flatten_dynamo_list(sample.get(k).get(k1))

                if k1 == 'M':
                    flat_dict[k] = flatten_dynamo_image(sample.get(k).get(k1))

                if k1 == "NULL":
                    flat_dict[k] = " "
    return flat_dict


def fast_flatten_dynamo_image(image):
    keyring = list(image.keys())
    return {key: image.get(key).get(list(image.get(key))[0]) for key in keyring}


def fast_stitch_dynamo_schema(dictionary, init_count):
    from datetime import datetime
    cnt = init_count
    update_expr = "SET "
    attr_names = dict()
    attr_dict = dict()

    DYNAMODB_RESERVED_WORDS = ['abort', 'absolute', 'action', 'add', 'after', 'agent', 'aggregate', 'all', 'allocate',
                               'alter', 'analyze', 'and', 'any', 'archive', 'are', 'array', 'as', 'asc', 'ascii',
                               'asensitive', 'assertion', 'asymmetric', 'at', 'atomic', 'attach', 'attribute', 'auth',
                               'authorization', 'authorize', 'auto', 'avg', 'back', 'backup', 'base', 'batch', 'before',
                               'begin', 'between', 'bigint', 'binary', 'bit', 'blob', 'block', 'boolean', 'both',
                               'breadth', 'bucket', 'bulk', 'by', 'byte', 'call', 'called', 'calling', 'capacity',
                               'cascade', 'cascaded', 'case', 'cast', 'catalog', 'char', 'character', 'check', 'class',
                               'clob', 'close', 'cluster', 'clustered', 'clustering', 'clusters', 'coalesce', 'collate',
                               'collation', 'collection', 'column', 'columns', 'combine', 'comment', 'commit',
                               'compact', 'compile', 'compress', 'condition', 'conflict', 'connect', 'connection',
                               'consistency', 'consistent', 'constraint', 'constraints', 'constructor', 'consumed',
                               'continue', 'convert', 'copy', 'corresponding', 'count', 'counter', 'create', 'cross',
                               'cube', 'current', 'cursor', 'cycle', 'data', 'database', 'date', 'datetime', 'day',
                               'deallocate', 'dec', 'decimal', 'declare', 'default', 'deferrable', 'deferred', 'define',
                               'defined', 'definition', 'delete', 'delimited', 'depth', 'deref', 'desc', 'describe',
                               'descriptor', 'detach', 'deterministic', 'diagnostics', 'directories', 'disable',
                               'disconnect', 'distinct', 'distribute', 'do', 'domain', 'double', 'drop', 'dump',
                               'duration', 'dynamic', 'each', 'element', 'else', 'elseif', 'empty', 'enable', 'end',
                               'equal', 'equals', 'error', 'escape', 'escaped', 'eval', 'evaluate', 'exceeded',
                               'except', 'exception', 'exceptions', 'exclusive', 'exec', 'execute', 'exists', 'exit',
                               'explain', 'explode', 'export', 'expression', 'extended', 'external', 'extract', 'fail',
                               'false', 'family', 'fetch', 'fields', 'file', 'filter', 'filtering', 'final', 'finish',
                               'first', 'fixed', 'flattern', 'float', 'for', 'force', 'foreign', 'format', 'forward',
                               'found', 'free', 'from', 'full', 'function', 'functions', 'general', 'generate', 'get',
                               'glob', 'global', 'go', 'goto', 'grant', 'greater', 'group', 'grouping', 'handler',
                               'hash', 'have', 'having', 'heap', 'hidden', 'hold', 'hour', 'identified', 'identity',
                               'if', 'ignore', 'immediate', 'import', 'in', 'including', 'inclusive', 'increment',
                               'incremental', 'index', 'indexed', 'indexes', 'indicator', 'infinite', 'initially',
                               'inline', 'inner', 'innter', 'inout', 'input', 'insensitive', 'insert', 'instead', 'int',
                               'integer', 'intersect', 'interval', 'into', 'invalidate', 'is', 'isolation', 'item',
                               'items', 'iterate', 'join', 'key', 'keys', 'lag', 'language', 'large', 'last', 'lateral',
                               'lead', 'leading', 'leave', 'left', 'length', 'less', 'level', 'like', 'limit',
                               'limited', 'lines', 'list', 'load', 'local', 'localtime', 'localtimestamp', 'location',
                               'locator', 'lock', 'locks', 'log', 'loged', 'long', 'loop', 'lower', 'map', 'match',
                               'materialized', 'max', 'maxlen', 'member', 'merge', 'method', 'metrics', 'min', 'minus',
                               'minute', 'missing', 'mod', 'mode', 'modifies', 'modify', 'module', 'month', 'multi',
                               'multiset', 'name', 'names', 'national', 'natural', 'nchar', 'nclob', 'new', 'next',
                               'no', 'none', 'not', 'null', 'nullif', 'number', 'numeric', 'object', 'of', 'offline',
                               'offset', 'old', 'on', 'online', 'only', 'opaque', 'open', 'operator', 'option', 'or',
                               'order', 'ordinality', 'other', 'others', 'out', 'outer', 'output', 'over', 'overlaps',
                               'override', 'owner', 'pad', 'parallel', 'parameter', 'parameters', 'partial',
                               'partition', 'partitioned', 'partitions', 'path', 'percent', 'percentile', 'permission',
                               'permissions', 'pipe', 'pipelined', 'plan', 'pool', 'position', 'precision', 'prepare',
                               'preserve', 'primary', 'prior', 'private', 'privileges', 'procedure', 'processed',
                               'project', 'projection', 'property', 'provisioning', 'public', 'put', 'query', 'quit',
                               'quorum', 'raise', 'random', 'range', 'rank', 'raw', 'read', 'reads', 'real', 'rebuild',
                               'record', 'recursive', 'reduce', 'ref', 'reference', 'references', 'referencing',
                               'regexp', 'region', 'reindex', 'relative', 'release', 'remainder', 'rename', 'repeat',
                               'replace', 'request', 'reset', 'resignal', 'resource', 'response', 'restore', 'restrict',
                               'result', 'return', 'returning', 'returns', 'reverse', 'revoke', 'right', 'role',
                               'roles', 'rollback', 'rollup', 'routine', 'row', 'rows', 'rule', 'rules', 'sample',
                               'satisfies', 'save', 'savepoint', 'scan', 'schema', 'scope', 'scroll', 'search',
                               'second', 'section', 'segment', 'segments', 'select', 'self', 'semi', 'sensitive',
                               'separate', 'sequence', 'serializable', 'session', 'set', 'sets', 'shard', 'share',
                               'shared', 'short', 'show', 'signal', 'similar', 'size', 'skewed', 'smallint', 'snapshot',
                               'some', 'source', 'space', 'spaces', 'sparse', 'specific', 'specifictype', 'split',
                               'sql', 'sqlcode', 'sqlerror', 'sqlexception', 'sqlstate', 'sqlwarning', 'start', 'state',
                               'static', 'status', 'storage', 'store', 'stored', 'stream', 'string', 'struct', 'style',
                               'sub', 'submultiset', 'subpartition', 'substring', 'subtype', 'sum', 'super',
                               'symmetric', 'synonym', 'system', 'table', 'tablesample', 'temp', 'temporary',
                               'terminated', 'text', 'than', 'then', 'throughput', 'time', 'timestamp', 'timezone',
                               'tinyint', 'to', 'token', 'total', 'touch', 'trailing', 'transaction', 'transform',
                               'translate', 'translation', 'treat', 'trigger', 'trim', 'true', 'truncate', 'ttl',
                               'tuple', 'type', 'under', 'undo', 'union', 'unique', 'unit', 'unknown', 'unlogged',
                               'unnest', 'unprocessed', 'unsigned', 'until', 'update', 'upper', 'url', 'usage', 'use',
                               'user', 'users', 'using', 'uuid', 'vacuum', 'value', 'valued', 'values', 'varchar',
                               'variable', 'variance', 'varint', 'varying', 'view', 'views', 'virtual', 'void', 'wait',
                               'when', 'whenever', 'where', 'while', 'window', 'with', 'within', 'without', 'work',
                               'wrapped', 'write', 'year', 'zone']
    dictionary['updated_dttm'] = datetime.now().strftime("%Y-%m-%dT%H:%M:%S.%fZ")
    for k, v in dictionary.items():
        if k not in ["CRM_lead_id"]:
            if k.lower() in DYNAMODB_RESERVED_WORDS:
                new_k = "#" + k[:-1]
                attr_names.update({new_k: k})
                k = new_k
            update_expr = update_expr + " " + k + " = " + ":var" + str(cnt + 1) + ", "
            ka = ':var' + str(cnt + 1)
            # va = list(dd.values())[cnt]
            attr_dict[ka] = v
            cnt = cnt + 1
    update_expr = update_expr[:-2]
    return update_expr, attr_dict, attr_names, cnt


x = flatten_dynamo_image(sample)
print(x)
